/* ===========================
   PSLaw Chat Widget – Navy + Orange (merged)
   =========================== */

/* Root theme tokens */
[data-pslaw-root] {
  --pslaw-primary: #ff4900;        /* orange */
  --pslaw-navy: #001f54;           /* deep navy */
  --pslaw-navy-ink: #0b2a6a;       /* lighter ink */
  --pslaw-white: #ffffff;
  --pslaw-gray: #f5f6f8;           /* soft chat bg */
  --pslaw-text: #343b4a;
  --pslaw-border: #e6e8ee;
  --pslaw-shadow: 0 10px 30px rgba(0, 0, 0, 0.22);
  --pslaw-fab-offset: 0px;
}

/* ===========================
   Floating Action Button (FAB)
   =========================== */
#pslaw-chat-fab {
  position: fixed !important;
  bottom: 20px !important;
  right: 20px !important;
  width: 60px !important;
  height: 60px !important;
  border-radius: 16px !important;
  background-color: var(--pslaw-primary) !important;
  background-image: url('/public/assets/pslaw-chat-icon.png');
  background-size: 90% !important;
  background-repeat: no-repeat !important;
  background-position: center !important;
  border: none !important;
  cursor: pointer !important;
  z-index: 2147483000 !important;
  box-shadow: var(--pslaw-shadow) !important;
  transition: transform 0.2s ease, box-shadow 0.2s ease !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

#pslaw-chat-fab:hover {
  transform: scale(1.05) !important;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.25) !important;
}

#pslaw-chat-fab:active {
  transform: scale(0.98) !important;
}

/* Fallback SVG when image not available */
#pslaw-chat-fab .pslaw-fab-fallback {
  width: 100% !important;
  height: 100% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  background: var(--pslaw-primary) !important;
  border-radius: 16px !important;
  color: #fff !important;
}

#pslaw-chat-fab .pslaw-fab-fallback svg {
  width: 32px !important;
  height: 32px !important;
}

/* ===========================
   Modal Overlay
   =========================== */
.pslaw-modal-overlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background: rgba(0, 0, 0, 0.45) !important;
  z-index: 2147483001 !important;
  opacity: 0 !important;
  transition: opacity 0.3s ease !important;
  pointer-events: none !important;
}

.pslaw-modal-overlay.pslaw-active {
  opacity: 1 !important;
  pointer-events: all !important;
}

/* ===========================
   Modal Container
   =========================== */
.pslaw-modal {
  position: fixed !important;
  z-index: 2147483002 !important; /* per request, unchanged */
  background: var(--pslaw-white) !important;
  border-radius: 18px !important;
  border: 1px solid rgba(0,0,0,.06) !important;
  box-shadow: var(--pslaw-shadow) !important;
  display: flex !important;
  flex-direction: column !important;
  opacity: 0 !important;
  transform: translateY(20px) !important;
  transition: opacity 0.3s ease, transform 0.3s ease !important;
  pointer-events: none !important;
}

.pslaw-modal.pslaw-active {
  opacity: 1 !important;
  transform: translateY(0) !important;
  pointer-events: all !important;
}

/* Desktop default size */
@media (min-width: 768px) {
  .pslaw-modal {
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, calc(-50% + 16px)) !important;
    width: min(96vw, 420px) !important;
    height: min(80vh, 620px) !important;
  }
  .pslaw-modal.pslaw-active {
    transform: translate(-50%, -50%) !important;
  }
}

/* Mobile floating drawer */
@media (max-width: 767px) {
  .pslaw-modal {
    left: 12px !important;
    right: 12px !important;
    bottom: 12px !important;
    height: 72vh !important;
    border-radius: 18px !important;
    transform: translateY(110%) !important;
  }
  .pslaw-modal.pslaw-active {
    transform: translateY(0) !important;
  }
}

/* ===========================
   Modal Header – Navy bar
   =========================== */
.pslaw-modal-header {
  padding: 14px 16px !important;
  border-bottom: none !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  flex-shrink: 0 !important;
  background: var(--pslaw-navy) !important;
  color: var(--pslaw-white) !important;
  border-radius: 18px 18px 0 0 !important;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,.06) !important;
}

.pslaw-modal-title {
  font-size: 18px !important;
  font-weight: 700 !important;
  color: var(--pslaw-white) !important;
  margin: 0 !important;
  font-family: 'Geologica', sans-serif !important;
  display: flex !important;
  align-items: center !important;
  gap: 10px !important;
}

/* Online status pill */
.pslaw-status {
  display: inline-flex !important;
  align-items: center !important;
  gap: 6px !important;
  padding: 2px 8px !important;
  font-size: 12px !important;
  border-radius: 999px !important;
  background: rgba(255,255,255,.12) !important;
  color: #c8d6ff !important;
}
.pslaw-status::before {
  content: "";
  width: 8px; height: 8px;
  border-radius: 50%;
  background: #27c93f;
  box-shadow: 0 0 0 2px rgba(39,201,63,.15);
  display: inline-block;
}

/* Header actions (expand + dark mode + close) */
.pslaw-header-actions {
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
}
.pslaw-action-btn,
.pslaw-modal-close {
  background: none !important;
  border: none !important;
  padding: 4px !important;
  cursor: pointer !important;
  border-radius: 6px !important;
  color: #e7ecff !important;
  opacity: 0.9 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  transition: background 0.2s, opacity 0.2s !important;
  line-height: 1 !important;
}
.pslaw-action-btn:hover,
.pslaw-modal-close:hover { background: rgba(255,255,255,0.15) !important; opacity: 1 !important; }
.pslaw-action-btn svg { display: block; }


/* Expand/collapse icons swap */
.pslaw-expand .collapse-icon { display: none; }
.pslaw-expanded .pslaw-expand .expand-icon { display: none; }
.pslaw-expanded .pslaw-expand .collapse-icon { display: block; }


/* ===========================
   Suggestion Chips
   =========================== */
.pslaw-suggestions {
  padding: 12px 14px !important;
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 8px !important;
  border-top: 1px solid var(--pslaw-border) !important;
  border-bottom: 1px solid var(--pslaw-border) !important;
  background: var(--pslaw-white) !important;
  flex-shrink: 0 !important;
}

.pslaw-chip {
  padding: 8px 14px !important;
  border-radius: 14px !important;
  font-size: 13px !important;
  cursor: pointer !important;
  transition: all 0.2s !important;
  white-space: nowrap !important;
  font-family: 'Open Sans', sans-serif !important;
  background: #f0f4ff !important;     /* light navy tint */
  border: 1px solid #dfe6f5 !important;
  color: #10356d !important;
}
.pslaw-chip:nth-child(2) {
  background: #fff3ea !important;      /* light orange */
  border-color: #ffe1cf !important;
  color: #7a2a00 !important;
}
.pslaw-chip:nth-child(3) {
  background: #f6f7fb !important;      /* neutral */
  border-color: #e9edf6 !important;
  color: #2c3552 !important;
}
.pslaw-chip:hover {
  background: var(--pslaw-primary) !important;
  border-color: var(--pslaw-primary) !important;
  color: #fff !important;
  transform: translateY(-1px) !important;
}

/* ===========================
   Messages Area & Bubbles
   =========================== */
.pslaw-messages {
  flex: 1 !important;
  overflow-y: auto !important;
  padding: 16px !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 12px !important;
  background: var(--pslaw-white) !important;
}

.pslaw-message {
  display: flex !important;
  gap: 8px !important;
  animation: pslaw-fadeIn 0.3s ease !important;
}
.pslaw-message.pslaw-user { justify-content: flex-end !important; }
.pslaw-message.pslaw-assistant { justify-content: flex-start !important; }

.pslaw-message-bubble {
  max-width: 75% !important;
  padding: 10px 14px !important;
  border-radius: 15px !important;
  font-size: 12px !important;
  line-height: 1.5 !important;
  word-wrap: break-word !important;
  font-family: 'Open Sans', sans-serif !important;
}
.pslaw-user .pslaw-message-bubble {
  background: var(--pslaw-navy) !important;
  color: #fff !important;
  border-bottom-right-radius: 4px !important;
}
.pslaw-assistant .pslaw-message-bubble {
  background: var(--pslaw-gray) !important;
  color: var(--pslaw-text) !important;
  border: 1px solid var(--pslaw-border) !important;
  border-bottom-left-radius: 4px !important;
}

/* Typing Indicator */
.pslaw-typing {
  display: flex !important;
  gap: 4px !important;
  padding: 12px !important;
  background: #eef3ff !important;
  border: 1px solid #d9e3ff !important;
  border-radius: 12px !important;
  width: fit-content !important;
}
.pslaw-typing-dot {
  width: 8px !important;
  height: 8px !important;
  background: var(--pslaw-text) !important;
  border-radius: 50% !important;
  opacity: 0.4 !important;
  animation: pslaw-pulse 1.4s infinite !important;
}
.pslaw-typing-dot:nth-child(2) { animation-delay: 0.2s !important; }
.pslaw-typing-dot:nth-child(3) { animation-delay: 0.4s !important; }

/* ===========================
   Input Area
   =========================== */
.pslaw-input-container {
  padding: 12px 12px 14px !important;
  border-top: 1px solid var(--pslaw-border) !important;
  display: flex !important;
  gap: 8px !important;
  align-items: flex-end !important;
  flex-shrink: 0 !important;
  background: #f9fbff !important;
}
.pslaw-input {
  flex: 1 !important;
  min-height: 40px !important;
  max-height: 120px !important;
  padding: 10px 14px !important;
  border: 1px solid #dfe3ee !important;
  border-radius: 18px !important;
  resize: none !important;
  font-size: 1rem !important;
  font-family: 'Open Sans', sans-serif !important;
  background: var(--pslaw-white) !important;
  color: var(--pslaw-text) !important;
  outline: none !important;
  transition: border-color 0.2s !important;
}
.pslaw-input:focus { border-color: var(--pslaw-navy) !important; }

.pslaw-send-btn {
  width: 42px !important;
  height: 42px !important;
  border-radius: 50% !important;
  background: var(--pslaw-navy) !important;
  border: none !important;
  color: white !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  transition: background 0.2s !important;
  flex-shrink: 0 !important;
  box-shadow: 0 2px 8px rgba(0,0,0,.12) !important;
}
.pslaw-send-btn:hover:not(:disabled) { background: var(--pslaw-primary) !important; }
.pslaw-send-btn:disabled { opacity: 0.5 !important; cursor: not-allowed !important; }

/* ===========================
   Footer & Quick Actions
   =========================== */
.pslaw-footer {
  padding: 8px 16px !important;
  background: #f6f7fb !important;
  font-size: 10px !important;
  font-weight: 600 !important;
  color: #5b6478 !important;
  text-align: center !important;
  border-top: 1px solid var(--pslaw-border) !important;
  font-family: 'Open Sans', sans-serif !important;
}
.pslaw-quick-actions {
  display: flex !important;
  gap: 8px !important;
  padding: 8px 16px !important;
  flex-wrap: wrap !important;
  justify-content: center !important;
}
.pslaw-quick-action {
  padding: 6px 12px !important;
  background: var(--pslaw-white) !important;
  border: 1px solid var(--pslaw-navy-ink) !important;
  border-radius: 16px !important;
  color: var(--pslaw-navy-ink) !important;
  font-size: 12px !important;
  text-decoration: none !important;
  transition: all 0.2s !important;
  font-family: 'Open Sans', sans-serif !important;
}
.pslaw-quick-action:hover {
  background: var(--pslaw-navy) !important;
  color: var(--pslaw-white) !important;
}

/* ===========================
   Error Message
   =========================== */
.pslaw-error {
  padding: 12px !important;
  background: #fee2e2 !important;
  border: 1px solid #fca5a5 !important;
  border-radius: 8px !important;
  color: #dc2626 !important;
  font-size: 13px !important;
  margin: 8px 16px !important;
  font-family: 'Open Sans', sans-serif !important;
}
.pslaw-retry-btn {
  margin-top: 8px !important;
  padding: 6px 12px !important;
  background: #dc2626 !important;
  color: white !important;
  border: none !important;
  border-radius: 4px !important;
  cursor: pointer !important;
  font-size: 12px !important;
  font-family: 'Open Sans', sans-serif !important;
}
.pslaw-retry-btn:hover { background: #b91c1c !important; }

/* ===========================
   Accessibility Focus Styles
   =========================== */
#pslaw-chat-fab:focus-visible,
.pslaw-modal-close:focus-visible,
.pslaw-chip:focus-visible,
.pslaw-send-btn:focus-visible,
.pslaw-quick-action:focus-visible,
.pslaw-action-btn:focus-visible {
  outline: 2px solid var(--pslaw-navy) !important;
  outline-offset: 2px !important;
}

/* Hide when not active */
[data-pslaw-root][hidden] { display: none !important; }

/* ===========================
   Animations
   =========================== */
@keyframes pslaw-fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes pslaw-pulse {
  0%, 60%, 100% { opacity: 0.4; }
  30% { opacity: 1; }
}

/* ===========================
   Dark Mode Variants
   =========================== */
[data-pslaw-root].pslaw-dark {
  --pslaw-white: #0e1624;       /* background base */
  --pslaw-gray: #1b2231;        /* bubble & drawer bg */
  --pslaw-text: #e0e6f5;        /* body text */
  --pslaw-border: #2a3244;
}
[data-pslaw-root].pslaw-dark .pslaw-modal-header {
  background: #000d2b !important;
  color: var(--pslaw-text) !important;
}
[data-pslaw-root].pslaw-dark .pslaw-modal-title { color: #f0f4ff !important; }
[data-pslaw-root].pslaw-dark .pslaw-status {
  background: rgba(255,255,255,.08) !important;
  color: #c4d0f7 !important;
}
[data-pslaw-root].pslaw-dark .pslaw-suggestions {
  background: #121a2b !important;
  border-color: var(--pslaw-border) !important;
}
[data-pslaw-root].pslaw-dark .pslaw-chip {
  background: #1b2539 !important;
  border-color: #2a3244 !important;
  color: #d1d9f0 !important;
}
[data-pslaw-root].pslaw-dark .pslaw-chip:hover {
  background: var(--pslaw-primary) !important;
  border-color: var(--pslaw-primary) !important;
  color: #fff !important;
}
[data-pslaw-root].pslaw-dark .pslaw-messages { background: #0e1624 !important; }
[data-pslaw-root].pslaw-dark .pslaw-assistant .pslaw-message-bubble {
  background: #1b2231 !important; border-color: #2a3244 !important; color: #d9e2f8 !important;
}
[data-pslaw-root].pslaw-dark .pslaw-user .pslaw-message-bubble {
  background: var(--pslaw-primary) !important; color: #fff !important;
}
[data-pslaw-root].pslaw-dark .pslaw-typing { background: #1b2231 !important; border-color: #2a3244 !important; }
[data-pslaw-root].pslaw-dark .pslaw-typing-dot { background: #d9e2f8 !important; }
[data-pslaw-root].pslaw-dark .pslaw-input-container {
  background: #121a2b !important; border-top: 1px solid var(--pslaw-border) !important;
}
[data-pslaw-root].pslaw-dark .pslaw-input {
  background: #1b2231 !important; border: 1px solid #2a3244 !important; color: #e0e6f5 !important;
}
[data-pslaw-root].pslaw-dark .pslaw-input::placeholder { color: #7f8dab !important; }
[data-pslaw-root].pslaw-dark .pslaw-send-btn { background: var(--pslaw-primary) !important; }
[data-pslaw-root].pslaw-dark .pslaw-send-btn:hover { background: #ff7236 !important; }
[data-pslaw-root].pslaw-dark .pslaw-footer { background: #121a2b !important; color: #aab3cc !important; }
[data-pslaw-root].pslaw-dark .pslaw-quick-action { border-color: #4b5a7a !important; color: #c9d2ec !important; }
[data-pslaw-root].pslaw-dark .pslaw-quick-action:hover { background: var(--pslaw-primary) !important; color: #fff !important; }

/* ===========================
   Expanded (App-like) Mode
   =========================== */
.pslaw-modal.pslaw-expanded {
  /* edge-to-edge app layout */
  top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important;
  width: 100vw !important; height: 100dvh !important;
  transform: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;                 /* app-like: no outer shadow */
  border: none !important;
}

/* When expanded, make header + input sticky for app feel */
.pslaw-modal.pslaw-expanded .pslaw-modal-header {
  position: sticky !important;
  top: 0 !important;
  z-index: 1 !important;
  border-radius: 0 !important;
}
.pslaw-modal.pslaw-expanded .pslaw-suggestions {
  position: sticky !important;
  top: 56px !important; /* sits just below header */
  z-index: 1 !important;
}
.pslaw-modal.pslaw-expanded .pslaw-input-container,
.pslaw-modal.pslaw-expanded .pslaw-footer {
  position: sticky !important;
  bottom: 0 !important;
  z-index: 1 !important;
}
.pslaw-modal.pslaw-expanded .pslaw-messages {
  padding: 16px clamp(12px, 2vw, 20px) !important;
}

/* Expanded + Dark: remove subtle dividers for cleaner canvas */
[data-pslaw-root].pslaw-dark .pslaw-modal.pslaw-expanded .pslaw-suggestions {
  border-top: 1px solid transparent !important;
  border-bottom: 1px solid transparent !important;
}

/* Hide overlay visual when expanded (but keep z-index intact) */
.pslaw-modal.pslaw-expanded ~ .pslaw-modal-overlay,
.pslaw-modal.pslaw-expanded + .pslaw-modal-overlay {
  background: transparent !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* Optional: nicer transition into expanded */
.pslaw-modal.pslaw-expanded { transition: border-radius 0.3s ease, box-shadow 0.3s ease !important; }